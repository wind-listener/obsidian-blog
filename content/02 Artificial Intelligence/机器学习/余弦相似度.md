---
title: "余弦相似度"
date: 2025-12-14
draft: false
---

这个问题既兼顾基础算法原理，又聚焦实际应用场景，特别有价值！向量余弦相似度是衡量高维向量方向一致性的核心算法，取值范围为[-1,1]，在深度学习中是特征匹配、语义关联的关键工具。

### 一、算法核心解析
#### 1. 核心定义
向量余弦相似度通过计算两个向量夹角的余弦值，判断它们的方向相似程度。值越接近1，方向越一致；越接近-1，方向越相反；接近0则无明显关联。

#### 2. 计算公式
对于n维向量A=(a₁,a₂,...,aₙ)和B=(b₁,b₂,...,bₙ)，公式为：
cosθ = (A·B) / (||A||×||B||)
- 分子A·B是向量的点积（对应元素相乘求和）。
- 分母是两个向量的L₂范数（模长）乘积，即各元素平方和开根号后的乘积。

#### 3. 关键特点
- 与向量长度无关：仅关注方向，不受特征缩放影响，适合高维稀疏向量。
- 计算高效：时间复杂度O(n)，适配深度学习中大规模高维特征（如百万维词向量）。
- 直观可解释：结果映射到固定区间，易理解和阈值判断。

---

### 二、深度学习中的典型应用
#### 1. 特征相似度匹配
- 用于卷积神经网络（CNN）的特征检索，比如图像检索中，计算查询图像与数据库图像的特征向量相似度，快速匹配同类图像。
- 在人脸识别中，将人脸图像通过CNN提取特征向量后，用余弦相似度判断是否为同一人。

#### 2. 文本语义关联任务
- 预训练语言模型（如BERT、Word2Vec）将文本/词语转化为语义向量后，通过余弦相似度计算语义相似度。
- 应用于文本聚类、同义词挖掘、问答系统（匹配问题与候选答案的语义向量）。

#### 3. 推荐系统
- 协同过滤中，计算用户/物品的特征向量相似度（如用户偏好向量、物品属性向量）。
- 生成个性化推荐列表，比如视频推荐、商品推荐中，匹配与用户历史偏好相似的内容。

#### 4. 模型训练与优化辅助
- 作为损失函数组件，比如在对比学习中，拉近正样本对的余弦相似度、拉远负样本对的距离（如SimCLR模型）。
- 辅助聚类任务，比如K-Means聚类中，用余弦相似度替代欧氏距离，更适合高维语义向量聚类。

#### 5. 模型效果评估
- 评估生成模型的输出质量，比如文本生成中，计算生成文本与参考文本的语义向量相似度。
- 衡量嵌入模型（Embedding Model）的表征能力，相似度区分度越高，模型表征效果越好。

